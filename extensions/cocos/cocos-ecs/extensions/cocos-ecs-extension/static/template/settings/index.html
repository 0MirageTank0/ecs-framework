<div id="app">
    <div class="settings-container">
        <!-- 头部 -->
        <div class="settings-header">
            <div class="header-title">
                <h1>🔧 ECS Framework 设置</h1>
                <p>配置ECS框架的行为和性能选项</p>
            </div>
            <div class="header-actions">
                <ui-button class="save-button" :class="{ dirty: isDirty, saving: saving }" 
                          @click="saveCurrentSettings" :disabled="saving">
                    <ui-icon value="confirm" v-if="!saving"></ui-icon>
                    <ui-icon value="loading" class="spin" v-if="saving"></ui-icon>
                    {{ saving ? '保存中...' : (isDirty ? '保存 *' : '保存') }}
                </ui-button>
                <ui-button class="export-button" @click="exportSettings">
                    <ui-icon value="download"></ui-icon>
                    导出
                </ui-button>
                <ui-button class="import-button" @click="importSettings">
                    <ui-icon value="upload"></ui-icon>
                    导入
                </ui-button>
                <ui-button class="reset-button" @click="resetSettings">
                    <ui-icon value="reset"></ui-icon>
                    重置
                </ui-button>
            </div>
        </div>

        <!-- 状态栏 -->
        <div class="status-bar" v-if="lastSaved">
            <span class="status-text">最后保存: {{ lastSaved }}</span>
        </div>

        <!-- 设置内容 -->
        <div class="settings-content">
            <!-- 代码生成设置 -->
            <div class="settings-section">
                <div class="section-header">
                    <h2>📝 代码生成设置</h2>
                    <p>配置自动生成代码的格式和选项</p>
                </div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>模板语言</label>
                        <ui-select v-model="settings.codeGeneration.template" @change="markDirty">
                            <option value="typescript">TypeScript</option>
                            <option value="javascript">JavaScript</option>
                        </ui-select>
                    </div>
                    <div class="setting-item">
                        <label>组件后缀</label>
                        <ui-input v-model="settings.codeGeneration.componentSuffix" 
                                  @change="markDirty" placeholder="Component"></ui-input>
                    </div>
                    <div class="setting-item">
                        <label>系统后缀</label>
                        <ui-input v-model="settings.codeGeneration.systemSuffix" 
                                  @change="markDirty" placeholder="System"></ui-input>
                    </div>
                    <div class="setting-item">
                        <label>缩进风格</label>
                        <ui-select v-model="settings.codeGeneration.indentStyle" @change="markDirty">
                            <option value="spaces">空格</option>
                            <option value="tabs">制表符</option>
                        </ui-select>
                    </div>
                    <div class="setting-item">
                        <label>缩进大小</label>
                        <ui-num-input v-model="settings.codeGeneration.indentSize" 
                                      @change="markDirty" :min="1" :max="8"></ui-num-input>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.codeGeneration.useStrictMode" @change="markDirty">
                            启用严格模式
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.codeGeneration.generateComments" @change="markDirty">
                            生成注释
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.codeGeneration.generateImports" @change="markDirty">
                            自动添加导入语句
                        </ui-checkbox>
                    </div>
                </div>
            </div>

            <!-- 性能监控设置 -->
            <div class="settings-section">
                <div class="section-header">
                    <h2>⚡ 性能监控设置</h2>
                    <p>配置性能监控和优化建议</p>
                </div>
                <div class="settings-grid">
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.performance.enableMonitoring" @change="markDirty">
                            启用性能监控
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.performance.enableFpsMonitoring" @change="markDirty">
                            启用FPS监控
                        </ui-checkbox>
                    </div>
                    <div class="setting-item">
                        <label>目标FPS</label>
                        <ui-num-input v-model="settings.performance.targetFps" 
                                      @change="markDirty" :min="30" :max="120"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>执行时间警告阈值 (ms)</label>
                        <ui-num-input v-model="settings.performance.warningThreshold" 
                                      @change="markDirty" :min="1" :max="100" :step="0.1"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>执行时间严重阈值 (ms)</label>
                        <ui-num-input v-model="settings.performance.criticalThreshold" 
                                      @change="markDirty" :min="1" :max="200" :step="0.1"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>内存警告阈值 (MB)</label>
                        <ui-num-input v-model="settings.performance.memoryWarningMB" 
                                      @change="markDirty" :min="10" :max="1000"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>内存严重阈值 (MB)</label>
                        <ui-num-input v-model="settings.performance.memoryCriticalMB" 
                                      @change="markDirty" :min="50" :max="2000"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>性能采样数量</label>
                        <ui-num-input v-model="settings.performance.maxRecentSamples" 
                                      @change="markDirty" :min="10" :max="300"></ui-num-input>
                    </div>
                </div>
            </div>

            <!-- 调试设置 -->
            <div class="settings-section">
                <div class="section-header">
                    <h2>🐛 调试设置</h2>
                    <p>配置调试模式和日志选项</p>
                </div>
                <div class="settings-grid">
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.debugging.enableDebugMode" @change="markDirty">
                            启用调试模式
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.debugging.showEntityCount" @change="markDirty">
                            显示实体数量
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.debugging.showSystemExecutionTime" @change="markDirty">
                            显示系统执行时间
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.debugging.enablePerformanceWarnings" @change="markDirty">
                            启用性能警告
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.debugging.enableDetailedLogs" @change="markDirty">
                            启用详细日志
                        </ui-checkbox>
                    </div>
                    <div class="setting-item">
                        <label>日志级别</label>
                        <ui-select v-model="settings.debugging.logLevel" @change="markDirty">
                            <option value="none">无</option>
                            <option value="error">错误</option>
                            <option value="warn">警告</option>
                            <option value="info">信息</option>
                            <option value="debug">调试</option>
                        </ui-select>
                    </div>
                </div>
            </div>

            <!-- 编辑器集成设置 -->
            <div class="settings-section">
                <div class="section-header">
                    <h2>⚙️ 编辑器集成</h2>
                    <p>配置与Cocos Creator的集成选项</p>
                </div>
                <div class="settings-grid">
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.editor.autoRefreshAssets" @change="markDirty">
                            自动刷新资源
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.editor.showWelcomePanelOnStartup" @change="markDirty">
                            启动时显示欢迎面板
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.editor.enableAutoUpdates" @change="markDirty">
                            启用自动更新
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.editor.enableNotifications" @change="markDirty">
                            启用通知
                        </ui-checkbox>
                    </div>
                    <div class="setting-item">
                        <label>更新频道</label>
                        <ui-select v-model="settings.editor.updateChannel" @change="markDirty">
                            <option value="stable">稳定版</option>
                            <option value="beta">测试版</option>
                            <option value="alpha">开发版</option>
                        </ui-select>
                    </div>
                </div>
            </div>

            <!-- 项目模板设置 -->
            <div class="settings-section">
                <div class="section-header">
                    <h2>📁 项目模板设置</h2>
                    <p>配置生成项目模板的默认选项</p>
                </div>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>默认实体名称</label>
                        <ui-input v-model="settings.template.defaultEntityName" 
                                  @change="markDirty" placeholder="GameEntity"></ui-input>
                    </div>
                    <div class="setting-item">
                        <label>默认组件名称</label>
                        <ui-input v-model="settings.template.defaultComponentName" 
                                  @change="markDirty" placeholder="CustomComponent"></ui-input>
                    </div>
                    <div class="setting-item">
                        <label>默认系统名称</label>
                        <ui-input v-model="settings.template.defaultSystemName" 
                                  @change="markDirty" placeholder="CustomSystem"></ui-input>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.template.createExampleFiles" @change="markDirty">
                            创建示例文件
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.template.includeDocumentation" @change="markDirty">
                            包含文档
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.template.useFactoryPattern" @change="markDirty">
                            使用工厂模式
                        </ui-checkbox>
                    </div>
                </div>
            </div>

            <!-- 事件系统设置 -->
            <div class="settings-section">
                <div class="section-header">
                    <h2>📡 事件系统设置</h2>
                    <p>配置事件系统的行为和性能</p>
                </div>
                <div class="settings-grid">
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.events.enableEventSystem" @change="markDirty">
                            启用事件系统
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.events.enableAsyncEvents" @change="markDirty">
                            启用异步事件
                        </ui-checkbox>
                    </div>
                    <div class="setting-item checkbox-item">
                        <ui-checkbox v-model="settings.events.enableEventBatching" @change="markDirty">
                            启用事件批处理
                        </ui-checkbox>
                    </div>
                    <div class="setting-item">
                        <label>默认事件优先级</label>
                        <ui-num-input v-model="settings.events.defaultEventPriority" 
                                      @change="markDirty" :min="-100" :max="100"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>批处理大小</label>
                        <ui-num-input v-model="settings.events.batchSize" 
                                      @change="markDirty" :min="1" :max="100"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>批处理延迟 (ms)</label>
                        <ui-num-input v-model="settings.events.batchDelay" 
                                      @change="markDirty" :min="1" :max="1000"></ui-num-input>
                    </div>
                    <div class="setting-item">
                        <label>最大事件监听器数</label>
                        <ui-num-input v-model="settings.events.maxEventListeners" 
                                      @change="markDirty" :min="10" :max="1000"></ui-num-input>
                    </div>
                </div>
            </div>
        </div>

        <!-- 底部提示 -->
        <div class="settings-footer">
            <div class="footer-info">
                <ui-icon value="info"></ui-icon>
                <span>设置将保存到项目目录的 .ecs-framework-settings.json 文件中</span>
            </div>
            <div class="footer-actions">
                <span class="dirty-indicator" v-if="isDirty">● 有未保存的更改</span>
            </div>
        </div>
    </div>
</div> 